- command: reg add HKCU\Software\Microsoft\Windows\CurrentVersion\Run /v [Value] /t [REG_SZ/REG_DWORD] /d [Data] /f
  description: Add a registry value to the specific path - typically abused by cyber threats to achieve persistence on a victim device.
  killchain:
    - Installation
    - Actions on Objectives
  mitre:
    Defense Evasion:
      - T1112
    Persistence:
      - T1547.001
    Privilege Escalation:
      - T1547.001
  os:
    - Windows
  references:
    - https://github.com/3CORESec/MAL-CL/tree/master/Descriptors/Windows/Reg
    - https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/reg
  risk: Medium
  risk_reason: Modifying startup-related registry keys can provide a cyber-threat with a strong persistence mechanism if not remediated.
  fidelity: Low
  fidelity_reason: This is a relatively common occurrence depending upon organization policy - if volume allows, these should be vetted to ensure abuse is not occurring.
  tool: reg
  threatactors:
    N/A:
      - N/A
- command: reg add HKCU\Software\Microsoft\Windows\CurrentVersion\RunOnce /v [Value] /t [REG_SZ/REG_DWORD] /d [Data] /f
  description: Add a registry value to the specific path - typically abused by cyber threats to achieve persistence on a victim device.
  killchain:
    - Installation
    - Actions on Objectives
  mitre:
    Defense Evasion:
      - T1112
    Persistence:
      - T1547.001
    Privilege Escalation:
      - T1547.001
  os:
    - Windows
  references:
    - https://github.com/3CORESec/MAL-CL/tree/master/Descriptors/Windows/Reg
    - https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/reg
  risk: Medium
  risk_reason: Modifying startup-related registry keys can provide a cyber-threat with a strong persistence mechanism if not remediated.
  fidelity: Low
  fidelity_reason: This is a relatively common occurrence depending upon organization policy - if volume allows, these should be vetted to ensure abuse is not occurring.
  tool: reg
  threatactors:
    N/A:
      - N/A
- command: reg add HKCU\Software\Microsoft\Windows\CurrentVersion\RunServices /v [Value] /t [REG_SZ/REG_DWORD] /d [Data] /f
  description: Add a registry value to the specific path - typically abused by cyber threats to achieve persistence on a victim device.
  killchain:
    - Installation
    - Actions on Objectives
  mitre:
    Defense Evasion:
      - T1112
    Persistence:
      - T1547.001
    Privilege Escalation:
      - T1547.001
  os:
    - Windows
  references:
    - https://github.com/3CORESec/MAL-CL/tree/master/Descriptors/Windows/Reg
    - https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/reg
  risk: Medium
  risk_reason: Modifying startup-related registry keys can provide a cyber-threat with a strong persistence mechanism if not remediated.
  fidelity: Low
  fidelity_reason: This is a relatively common occurrence depending upon organization policy - if volume allows, these should be vetted to ensure abuse is not occurring.
  tool: reg
  threatactors:
    N/A:
      - N/A
- command: reg add HKCU\Software\Microsoft\Windows\CurrentVersion\RunServicesOnce /v [Value] /t [REG_SZ/REG_DWORD] /d [Data] /f
  description: Add a registry value to the specific path - typically abused by cyber threats to achieve persistence on a victim device.
  killchain:
    - Installation
    - Actions on Objectives
  mitre:
    Defense Evasion:
      - T1112
    Persistence:
      - T1547.001
    Privilege Escalation:
      - T1547.001
  os:
    - Windows
  references:
    - https://github.com/3CORESec/MAL-CL/tree/master/Descriptors/Windows/Reg
    - https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/reg
  risk: Medium
  risk_reason: Modifying startup-related registry keys can provide a cyber-threat with a strong persistence mechanism if not remediated.
  fidelity: Low
  fidelity_reason: This is a relatively common occurrence depending upon organization policy - if volume allows, these should be vetted to ensure abuse is not occurring.
  tool: reg
  threatactors:
    N/A:
      - N/A
- command: reg add HKCU\Software\Wow6432Node\Microsoft\Windows\CurrentVersion\RunOnce /v [Value] /t [REG_SZ/REG_DWORD] /d [Data] /f
  description: Add a registry value to the specific path - typically abused by cyber threats to achieve persistence on a victim device.
  killchain:
    - Installation
    - Actions on Objectives
  mitre:
    Defense Evasion:
      - T1112
    Persistence:
      - T1547.001
    Privilege Escalation:
      - T1547.001
  os:
    - Windows
  references:
    - https://github.com/3CORESec/MAL-CL/tree/master/Descriptors/Windows/Reg
    - https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/reg
  risk: Medium
  risk_reason: Modifying startup-related registry keys can provide a cyber-threat with a strong persistence mechanism if not remediated.
  fidelity: Low
  fidelity_reason: This is a relatively common occurrence depending upon organization policy - if volume allows, these should be vetted to ensure abuse is not occurring.
  tool: reg
  threatactors:
    N/A:
      - N/A
- command: reg add HKCU\Software\Wow6432Node\Microsoft\Windows\CurrentVersion\Run /v [Value] /t [REG_SZ/REG_DWORD] /d [Data] /f
  description: Add a registry value to the specific path - typically abused by cyber threats to achieve persistence on a victim device.
  killchain:
    - Installation
    - Actions on Objectives
  mitre:
    Defense Evasion:
      - T1112
    Persistence:
      - T1547.001
    Privilege Escalation:
      - T1547.001
  os:
    - Windows
  references:
    - https://github.com/3CORESec/MAL-CL/tree/master/Descriptors/Windows/Reg
    - https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/reg
  risk: Medium
  risk_reason: Modifying startup-related registry keys can provide a cyber-threat with a strong persistence mechanism if not remediated.
  fidelity: Low
  fidelity_reason: This is a relatively common occurrence depending upon organization policy - if volume allows, these should be vetted to ensure abuse is not occurring.
  tool: reg
  threatactors:
    N/A:
      - N/A
- command: reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders" /v [Value] /t [REG_SZ/REG_DWORD] /d [Data] /f
  description: Add a registry value to the specific path - typically abused by cyber threats to achieve persistence on a victim device.
  killchain:
    - Installation
    - Actions on Objectives
  mitre:
    Defense Evasion:
      - T1112
    Persistence:
      - T1547.001
    Privilege Escalation:
      - T1547.001
  os:
    - Windows
  references:
    - https://github.com/3CORESec/MAL-CL/tree/master/Descriptors/Windows/Reg
    - https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/reg
  risk: Medium
  risk_reason: Modifying startup-related registry keys can provide a cyber-threat with a strong persistence mechanism if not remediated.
  fidelity: Low
  fidelity_reason: This is a relatively common occurrence depending upon organization policy - if volume allows, these should be vetted to ensure abuse is not occurring.
  tool: reg
  threatactors:
    N/A:
      - N/A
- command: reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders" /v [Value] /t [REG_SZ/REG_DWORD] /d [Data] /f
  description: Add a registry value to the specific path - typically abused by cyber threats to achieve persistence on a victim device.
  killchain:
    - Installation
    - Actions on Objectives
  mitre:
    Defense Evasion:
      - T1112
    Persistence:
      - T1547.001
    Privilege Escalation:
      - T1547.001
  os:
    - Windows
  references:
    - https://github.com/3CORESec/MAL-CL/tree/master/Descriptors/Windows/Reg
    - https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/reg
  risk: Medium
  risk_reason: Modifying startup-related registry keys can provide a cyber-threat with a strong persistence mechanism if not remediated.
  fidelity: Low
  fidelity_reason: This is a relatively common occurrence depending upon organization policy - if volume allows, these should be vetted to ensure abuse is not occurring.
  tool: reg
  threatactors:
    N/A:
      - N/A
- command: reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run" /v [Value] /t [REG_SZ/REG_DWORD] /d [Data] /f
  description: Add a registry value to the specific path - typically abused by cyber threats to achieve persistence on a victim device.
  killchain:
    - Installation
    - Actions on Objectives
  mitre:
    Defense Evasion:
      - T1112
    Persistence:
      - T1547.001
    Privilege Escalation:
      - T1547.001
  os:
    - Windows
  references:
    - https://github.com/3CORESec/MAL-CL/tree/master/Descriptors/Windows/Reg
    - https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/reg
  risk: Medium
  risk_reason: Modifying startup-related registry keys can provide a cyber-threat with a strong persistence mechanism if not remediated.
  fidelity: Low
  fidelity_reason: This is a relatively common occurrence depending upon organization policy - if volume allows, these should be vetted to ensure abuse is not occurring.
  tool: reg
  threatactors:
    N/A:
      - N/A
- command: reg add "HKCU\Software\Microsoft\Windows NT\CurrentVersion\Windows" /v [Value] /t [REG_SZ/REG_DWORD] /d [Data] /f
  description: Add a registry value to the specific path - typically abused by cyber threats to achieve persistence on a victim device.
  killchain:
    - Installation
    - Actions on Objectives
  mitre:
    Defense Evasion:
      - T1112
    Persistence:
      - T1547.001
    Privilege Escalation:
      - T1547.001
  os:
    - Windows
  references:
    - https://github.com/3CORESec/MAL-CL/tree/master/Descriptors/Windows/Reg
    - https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/reg
  risk: Medium
  risk_reason: Modifying startup-related registry keys can provide a cyber-threat with a strong persistence mechanism if not remediated.
  fidelity: Low
  fidelity_reason: This is a relatively common occurrence depending upon organization policy - if volume allows, these should be vetted to ensure abuse is not occurring.
  tool: reg
  threatactors:
    N/A:
      - N/A
- command: reg add "HKCU\Software\Microsoft\Active Setup\Installed Components" /v [Value] /t [REG_SZ/REG_DWORD] /d [Data] /f
  description: Add a registry value to the specific path - typically abused by cyber threats to achieve persistence on a victim device.
  killchain:
    - Installation
    - Actions on Objectives
  mitre:
    Defense Evasion:
      - T1112
    Persistence:
      - T1547.001
    Privilege Escalation:
      - T1547.001
  os:
    - Windows
  references:
    - https://github.com/3CORESec/MAL-CL/tree/master/Descriptors/Windows/Reg
    - https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/reg
  risk: Medium
  risk_reason: Modifying startup-related registry keys can provide a cyber-threat with a strong persistence mechanism if not remediated.
  fidelity: Low
  fidelity_reason: This is a relatively common occurrence depending upon organization policy - if volume allows, these should be vetted to ensure abuse is not occurring.
  tool: reg
  threatactors:
    N/A:
      - N/A
- command: reg add "HKLM\Software\Microsoft\Windows\CurrentVersion\Run" /v [Value] /t [REG_SZ/REG_DWORD] /d [Data] /f
  description: Add a registry value to the specific path - typically abused by cyber threats to achieve persistence on a victim device.
  killchain:
    - Installation
    - Actions on Objectives
  mitre:
    Defense Evasion:
      - T1112
    Persistence:
      - T1547.001
    Privilege Escalation:
      - T1547.001
  os:
    - Windows
  references:
    - https://github.com/3CORESec/MAL-CL/tree/master/Descriptors/Windows/Reg
    - https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/reg
  risk: Medium
  risk_reason: Modifying startup-related registry keys can provide a cyber-threat with a strong persistence mechanism if not remediated.
  fidelity: Low
  fidelity_reason: This is a relatively common occurrence depending upon organization policy - if volume allows, these should be vetted to ensure abuse is not occurring.
  tool: reg
  threatactors:
    N/A:
      - N/A
- command: reg add "HKLM\Software\Microsoft\Windows\CurrentVersion\RunOnce" /v [Value] /t [REG_SZ/REG_DWORD] /d [Data] /f
  description: Add a registry value to the specific path - typically abused by cyber threats to achieve persistence on a victim device.
  killchain:
    - Installation
    - Actions on Objectives
  mitre:
    Defense Evasion:
      - T1112
    Persistence:
      - T1547.001
    Privilege Escalation:
      - T1547.001
  os:
    - Windows
  references:
    - https://github.com/3CORESec/MAL-CL/tree/master/Descriptors/Windows/Reg
    - https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/reg
  risk: Medium
  risk_reason: Modifying startup-related registry keys can provide a cyber-threat with a strong persistence mechanism if not remediated.
  fidelity: Low
  fidelity_reason: This is a relatively common occurrence depending upon organization policy - if volume allows, these should be vetted to ensure abuse is not occurring.
  tool: reg
  threatactors:
    N/A:
      - N/A
- command: reg add "HKLM\Software\Microsoft\Windows\CurrentVersion\RunServices" /v [Value] /t [REG_SZ/REG_DWORD] /d [Data] /f
  description: Add a registry value to the specific path - typically abused by cyber threats to achieve persistence on a victim device.
  killchain:
    - Installation
    - Actions on Objectives
  mitre:
    Defense Evasion:
      - T1112
    Persistence:
      - T1547.001
    Privilege Escalation:
      - T1547.001
  os:
    - Windows
  references:
    - https://github.com/3CORESec/MAL-CL/tree/master/Descriptors/Windows/Reg
    - https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/reg
  risk: Medium
  risk_reason: Modifying startup-related registry keys can provide a cyber-threat with a strong persistence mechanism if not remediated.
  fidelity: Low
  fidelity_reason: This is a relatively common occurrence depending upon organization policy - if volume allows, these should be vetted to ensure abuse is not occurring.
  tool: reg
  threatactors:
    N/A:
      - N/A
- command: reg add "HKLM\Software\Microsoft\Windows\CurrentVersion\RunServicesOnce" /v [Value] /t [REG_SZ/REG_DWORD] /d [Data] /f
  description: Add a registry value to the specific path - typically abused by cyber threats to achieve persistence on a victim device.
  killchain:
    - Installation
    - Actions on Objectives
  mitre:
    Defense Evasion:
      - T1112
    Persistence:
      - T1547.001
    Privilege Escalation:
      - T1547.001
  os:
    - Windows
  references:
    - https://github.com/3CORESec/MAL-CL/tree/master/Descriptors/Windows/Reg
    - https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/reg
  risk: Medium
  risk_reason: Modifying startup-related registry keys can provide a cyber-threat with a strong persistence mechanism if not remediated.
  fidelity: Low
  fidelity_reason: This is a relatively common occurrence depending upon organization policy - if volume allows, these should be vetted to ensure abuse is not occurring.
  tool: reg
  threatactors:
    N/A:
      - N/A
- command: reg add "HKLM\Software\Wow6432Node\Microsoft\Windows\CurrentVersion\Run" /v [Value] /t [REG_SZ/REG_DWORD] /d [Data] /f
  description: Add a registry value to the specific path - typically abused by cyber threats to achieve persistence on a victim device.
  killchain:
    - Installation
    - Actions on Objectives
  mitre:
    Defense Evasion:
      - T1112
    Persistence:
      - T1547.001
    Privilege Escalation:
      - T1547.001
  os:
    - Windows
  references:
    - https://github.com/3CORESec/MAL-CL/tree/master/Descriptors/Windows/Reg
    - https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/reg
  risk: Medium
  risk_reason: Modifying startup-related registry keys can provide a cyber-threat with a strong persistence mechanism if not remediated.
  fidelity: Low
  fidelity_reason: This is a relatively common occurrence depending upon organization policy - if volume allows, these should be vetted to ensure abuse is not occurring.
  tool: reg
  threatactors:
    N/A:
      - N/A
- command: reg add "HKLM\Software\Wow6432Node\Microsoft\Windows\CurrentVersion\RunOnce" /v [Value] /t [REG_SZ/REG_DWORD] /d [Data] /f
  description: Add a registry value to the specific path - typically abused by cyber threats to achieve persistence on a victim device.
  killchain:
    - Installation
    - Actions on Objectives
  mitre:
    Defense Evasion:
      - T1112
    Persistence:
      - T1547.001
    Privilege Escalation:
      - T1547.001
  os:
    - Windows
  references:
    - https://github.com/3CORESec/MAL-CL/tree/master/Descriptors/Windows/Reg
    - https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/reg
  risk: Medium
  risk_reason: Modifying startup-related registry keys can provide a cyber-threat with a strong persistence mechanism if not remediated.
  fidelity: Low
  fidelity_reason: This is a relatively common occurrence depending upon organization policy - if volume allows, these should be vetted to ensure abuse is not occurring.
  tool: reg
  threatactors:
    N/A:
      - N/A
- command: reg add "HKLM\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders" /v [Value] /t [REG_SZ/REG_DWORD] /d [Data] /f
  description: Add a registry value to the specific path - typically abused by cyber threats to achieve persistence on a victim device.
  killchain:
    - Installation
    - Actions on Objectives
  mitre:
    Defense Evasion:
      - T1112
    Persistence:
      - T1547.001
    Privilege Escalation:
      - T1547.001
  os:
    - Windows
  references:
    - https://github.com/3CORESec/MAL-CL/tree/master/Descriptors/Windows/Reg
    - https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/reg
  risk: Medium
  risk_reason: Modifying startup-related registry keys can provide a cyber-threat with a strong persistence mechanism if not remediated.
  fidelity: Low
  fidelity_reason: This is a relatively common occurrence depending upon organization policy - if volume allows, these should be vetted to ensure abuse is not occurring.
  tool: reg
  threatactors:
    N/A:
      - N/A
- command: reg add "HKLM\Software\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders" /v [Value] /t [REG_SZ/REG_DWORD] /d [Data] /f
  description: Add a registry value to the specific path - typically abused by cyber threats to achieve persistence on a victim device.
  killchain:
    - Installation
    - Actions on Objectives
  mitre:
    Defense Evasion:
      - T1112
    Persistence:
      - T1547.001
    Privilege Escalation:
      - T1547.001
  os:
    - Windows
  references:
    - https://github.com/3CORESec/MAL-CL/tree/master/Descriptors/Windows/Reg
    - https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/reg
  risk: Medium
  risk_reason: Modifying startup-related registry keys can provide a cyber-threat with a strong persistence mechanism if not remediated.
  fidelity: Low
  fidelity_reason: This is a relatively common occurrence depending upon organization policy - if volume allows, these should be vetted to ensure abuse is not occurring.
  tool: reg
  threatactors:
    N/A:
      - N/A
- command: reg add "HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run" /v [Value] /t [REG_SZ/REG_DWORD] /d [Data] /f
  description: Add a registry value to the specific path - typically abused by cyber threats to achieve persistence on a victim device.
  killchain:
    - Installation
    - Actions on Objectives
  mitre:
    Defense Evasion:
      - T1112
    Persistence:
      - T1547.001
    Privilege Escalation:
      - T1547.001
  os:
    - Windows
  references:
    - https://github.com/3CORESec/MAL-CL/tree/master/Descriptors/Windows/Reg
    - https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/reg
  risk: Medium
  risk_reason: Modifying startup-related registry keys can provide a cyber-threat with a strong persistence mechanism if not remediated.
  fidelity: Low
  fidelity_reason: This is a relatively common occurrence depending upon organization policy - if volume allows, these should be vetted to ensure abuse is not occurring.
  tool: reg
  threatactors:
    N/A:
      - N/A
- command: reg add "HKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Userinit" /v [Value] /t [REG_SZ/REG_DWORD] /d [Data] /f
  description: Add a registry value to the specific path - typically abused by cyber threats to achieve persistence on a victim device.
  killchain:
    - Installation
    - Actions on Objectives
  mitre:
    Defense Evasion:
      - T1112
    Persistence:
      - T1547.001
    Privilege Escalation:
      - T1547.001
  os:
    - Windows
  references:
    - https://github.com/3CORESec/MAL-CL/tree/master/Descriptors/Windows/Reg
    - https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/reg
  risk: Medium
  risk_reason: Modifying startup-related registry keys can provide a cyber-threat with a strong persistence mechanism if not remediated.
  fidelity: Low
  fidelity_reason: This is a relatively common occurrence depending upon organization policy - if volume allows, these should be vetted to ensure abuse is not occurring.
  tool: reg
  threatactors:
    N/A:
      - N/A
- command: reg add "HKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Shell" /v [Value] /t [REG_SZ/REG_DWORD] /d [Data] /f
  description: Add a registry value to the specific path - typically abused by cyber threats to achieve persistence on a victim device.
  killchain:
    - Installation
    - Actions on Objectives
  mitre:
    Defense Evasion:
      - T1112
    Persistence:
      - T1547.001
    Privilege Escalation:
      - T1547.001
  os:
    - Windows
  references:
    - https://github.com/3CORESec/MAL-CL/tree/master/Descriptors/Windows/Reg
    - https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/reg
  risk: Medium
  risk_reason: Modifying startup-related registry keys can provide a cyber-threat with a strong persistence mechanism if not remediated.
  fidelity: Low
  fidelity_reason: This is a relatively common occurrence depending upon organization policy - if volume allows, these should be vetted to ensure abuse is not occurring.
  tool: reg
  threatactors:
    N/A:
      - N/A
- command: reg add "HKLM\System\CurrentControlSet\Control\Terminal Server\fDenyTSConnections" /v [Value] /t [REG_SZ/REG_DWORD] /d [Data] /f
  description: Add a registry value to the specific path - typically abused by cyber threats to achieve persistence on a victim device.
  killchain:
    - Installation
    - Actions on Objectives
  mitre:
    Defense Evasion:
      - T1112
    Persistence:
      - T1547.001
    Privilege Escalation:
      - T1547.001
  os:
    - Windows
  references:
    - https://github.com/3CORESec/MAL-CL/tree/master/Descriptors/Windows/Reg
    - https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/reg
  risk: Medium
  risk_reason: Modifying startup-related registry keys can provide a cyber-threat with a strong persistence mechanism if not remediated.
  fidelity: Low
  fidelity_reason: This is a relatively common occurrence depending upon organization policy - if volume allows, these should be vetted to ensure abuse is not occurring.
  tool: reg
  threatactors:
    N/A:
      - N/A
- command: reg add "HKLM\System\CurrentControlSet\Control\Terminal Server\fSingleSessionPerUser" /v [Value] /t [REG_SZ/REG_DWORD] /d [Data] /f
  description: Add a registry value to the specific path - typically abused by cyber threats to achieve persistence on a victim device.
  killchain:
    - Installation
    - Actions on Objectives
  mitre:
    Defense Evasion:
      - T1112
    Persistence:
      - T1547.001
    Privilege Escalation:
      - T1547.001
  os:
    - Windows
  references:
    - https://github.com/3CORESec/MAL-CL/tree/master/Descriptors/Windows/Reg
    - https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/reg
  risk: Medium
  risk_reason: Modifying startup-related registry keys can provide a cyber-threat with a strong persistence mechanism if not remediated.
  fidelity: Low
  fidelity_reason: This is a relatively common occurrence depending upon organization policy - if volume allows, these should be vetted to ensure abuse is not occurring.
  tool: reg
  threatactors:
    N/A:
      - N/A
- command: reg add "HKLM\System\CurrentControlSet\Control\Terminal Server\Licensing Core\EnableConcurrentSessions" /v [Value] /t [REG_SZ/REG_DWORD] /d [Data] /f
  description: Add a registry value to the specific path - typically abused by cyber threats to achieve persistence on a victim device.
  killchain:
    - Installation
    - Actions on Objectives
  mitre:
    Defense Evasion:
      - T1112
    Persistence:
      - T1547.001
    Privilege Escalation:
      - T1547.001
  os:
    - Windows
  references:
    - https://github.com/3CORESec/MAL-CL/tree/master/Descriptors/Windows/Reg
    - https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/reg
  risk: Medium
  risk_reason: Modifying startup-related registry keys can provide a cyber-threat with a strong persistence mechanism if not remediated.
  fidelity: Low
  fidelity_reason: This is a relatively common occurrence depending upon organization policy - if volume allows, these should be vetted to ensure abuse is not occurring.
  tool: reg
  threatactors:
    N/A:
      - N/A
- command: reg add "HKLM\System\CurrentControlSet\Services\Ntds\Parameters" /v [Value] /t [REG_SZ/REG_DWORD] /d [Data] /f
  description: Add a registry value to the specific path - typically abused by cyber threats to achieve persistence on a victim device.
  killchain:
    - Installation
    - Actions on Objectives
  mitre:
    Defense Evasion:
      - T1112
    Persistence:
      - T1547.001
    Privilege Escalation:
      - T1547.001
  os:
    - Windows
  references:
    - https://github.com/3CORESec/MAL-CL/tree/master/Descriptors/Windows/Reg
    - https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/reg
  risk: Medium
  risk_reason: Modifying startup-related registry keys can provide a cyber-threat with a strong persistence mechanism if not remediated.
  fidelity: Low
  fidelity_reason: This is a relatively common occurrence depending upon organization policy - if volume allows, these should be vetted to ensure abuse is not occurring.
  tool: reg
  threatactors:
    N/A:
      - N/A
- command: reg add "HKLM\System\CurrentControlSet\Control\SecurityProviders\WDigest\UseLogonCredential" /v [Value] /t [REG_SZ/REG_DWORD] /d [Data] /f
  description: Add a registry value to the specific path - typically abused by cyber threats to achieve persistence on a victim device.
  killchain:
    - Installation
    - Actions on Objectives
  mitre:
    Defense Evasion:
      - T1112
    Persistence:
      - T1547.001
    Privilege Escalation:
      - T1547.001
  os:
    - Windows
  references:
    - https://github.com/3CORESec/MAL-CL/tree/master/Descriptors/Windows/Reg
    - https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/reg
  risk: Medium
  risk_reason: Modifying startup-related registry keys can provide a cyber-threat with a strong persistence mechanism if not remediated.
  fidelity: Low
  fidelity_reason: This is a relatively common occurrence depending upon organization policy - if volume allows, these should be vetted to ensure abuse is not occurring.
  tool: reg
  threatactors:
    N/A:
      - N/A
- command: reg add "HKLM\Security\Policy\Secrets" /v [Value] /t [REG_SZ/REG_DWORD] /d [Data] /f
  description: Add a registry value to the specific path - typically abused by cyber threats to achieve persistence on a victim device.
  killchain:
    - Installation
    - Actions on Objectives
  mitre:
    Defense Evasion:
      - T1112
    Persistence:
      - T1547.001
    Privilege Escalation:
      - T1547.001
  os:
    - Windows
  references:
    - https://github.com/3CORESec/MAL-CL/tree/master/Descriptors/Windows/Reg
    - https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/reg
  risk: Medium
  risk_reason: Modifying startup-related registry keys can provide a cyber-threat with a strong persistence mechanism if not remediated.
  fidelity: Low
  fidelity_reason: This is a relatively common occurrence depending upon organization policy - if volume allows, these should be vetted to ensure abuse is not occurring.
  tool: reg
  threatactors:
    N/A:
      - N/A
- command: reg add "HKCU\Software\Classes\mscfile\shell\open\command" /v [Value] /t [REG_SZ/REG_DWORD] /d [Data] /f
  description: Modifying the default mmc.exe location can cause a high-integrity arbitrary executable to be run without a UAC prompt when 'eventvwr.exe' is launched.
  killchain:
    - Installation
    - Actions on Objectives
  mitre:
    Defense Evasion:
      - T1112
    Persistence:
      - T1547.001
    Privilege Escalation:
      - T1547.001
  os:
    - Windows
  references:
    - https://github.com/3CORESec/MAL-CL/tree/master/Descriptors/Windows/Reg
    - https://lolbas-project.github.io/lolbas/Binaries/Eventvwr/
    - https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/reg
    - https://enigma0x3.net/2016/08/15/fileless-uac-bypass-using-eventvwr-exe-and-registry-hijacking/
  risk: Medium
  risk_reason: Modifying startup-related registry keys can provide a cyber-threat with a strong persistence mechanism if not remediated.
  fidelity: High
  fidelity_reason: This is a relatively uncommon occurrence depending upon organization policy.
  tool: reg
  threatactors:
    N/A:
      - N/A
- command: reg save HKLM\SECURITY c:\test\security.bak && reg save HKLM\SYSTEM c:\test\system.bak && reg save HKLM\SAM c:\test\sam.bak
  description: Export and save various security-focused pieces of the registry to perform offline retrieval of hashes, key material, etc.
  killchain:
    - Installation
    - Actions on Objectives
  mitre:
    Credential Access:
      - T1003.002
  os:
    - Windows
  references:
    - https://lolbas-project.github.io/lolbas/Binaries/Reg/
  risk: Critical
  risk_reason: Exporting sensitive registry data typically has few to none legitimate explanations.
  fidelity: High
  fidelity_reason: This is a relatively rare type of behavior.
  tool: reg
  threatactors:
    N/A:
      - N/A
# TODO - reg query HKEY_CURRENT_USER\Software\Policies\Microsoft\Windows\Installer, reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer
# Check Always Install Elevated


